{
"version":3,
"file":"com.cognitect.transit.impl.writer.js",
"lineCount":416,
"mappings":"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",
"sources":["com.cognitect.transit.impl.writer.js"],
"sourcesContent":["goog.provide(\"com.cognitect.transit.impl.writer\");\ngoog.require(\"com.cognitect.transit.util\");\ngoog.require(\"com.cognitect.transit.caching\");\ngoog.require(\"com.cognitect.transit.handlers\");\ngoog.require(\"com.cognitect.transit.types\");\ngoog.require(\"com.cognitect.transit.delimiters\");\ngoog.require(\"goog.math.Long\");\ngoog.scope(function() {\n  var writer = com.cognitect.transit.impl.writer, util = com.cognitect.transit.util, caching = com.cognitect.transit.caching, handlers = com.cognitect.transit.handlers, types = com.cognitect.transit.types, d = com.cognitect.transit.delimiters, Long = goog.math.Long;\n  writer.escape = function(string) {\n    if (string.length > 0) {\n      var c = string.charAt(0);\n      if (c === d.ESC || c === d.SUB || c === d.RES) {\n        return d.ESC + string;\n      } else {\n        return string;\n      }\n    } else {\n      return string;\n    }\n  };\n  writer.JSONMarshaller = function Transit$JSONMarshaller(opts) {\n    this.opts = opts || {};\n    this.preferStrings = this.opts[\"preferStrings\"] != null ? this.opts[\"preferStrings\"] : true;\n    this.objectBuilder = this.opts[\"objectBuilder\"] || null;\n    this.transform = this.opts[\"transform\"] || null;\n    this.handlers = new handlers.Handlers();\n    var optsHandlers = this.opts[\"handlers\"];\n    if (optsHandlers) {\n      if (util.isArray(optsHandlers) || !optsHandlers.forEach) {\n        throw new Error('transit writer \"handlers\" option must be a map');\n      }\n      var self = this;\n      optsHandlers.forEach(function(v, k) {\n        if (k !== undefined) {\n          self.handlers.set(k, v);\n        } else {\n          throw new Error(\"Cannot create handler for JavaScript undefined\");\n        }\n      });\n    }\n    this.handlerForForeign = this.opts[\"handlerForForeign\"];\n    this.unpack = this.opts[\"unpack\"] || function(x) {\n      if (types.isArrayMap(x) && x.backingMap === null) {\n        return x._entries;\n      } else {\n        return false;\n      }\n    };\n    this.verbose = this.opts && this.opts[\"verbose\"] || false;\n  };\n  writer.JSONMarshaller.prototype.handler = function(obj) {\n    var h = this.handlers.get(handlers.constructor(obj));\n    if (h != null) {\n      return h;\n    } else {\n      var tag = obj && obj[\"transitTag\"];\n      if (tag) {\n        return this.handlers.get(tag);\n      } else {\n        return null;\n      }\n    }\n  };\n  writer.JSONMarshaller.prototype.registerHandler = function(ctor, handler) {\n    this.handlers.set(ctor, handler);\n  };\n  writer.JSONMarshaller.prototype.emitNil = function(asMapKey, cache) {\n    if (asMapKey) {\n      return this.emitString(d.ESC, \"_\", \"\", asMapKey, cache);\n    } else {\n      return null;\n    }\n  };\n  writer.JSONMarshaller.prototype.emitString = function(prefix, tag, s, asMapKey, cache) {\n    var string = prefix + tag + s;\n    if (cache) {\n      return cache.write(string, asMapKey);\n    } else {\n      return string;\n    }\n  };\n  writer.JSONMarshaller.prototype.emitBoolean = function(b, asMapKey, cache) {\n    if (asMapKey) {\n      var s = b.toString();\n      return this.emitString(d.ESC, \"?\", s[0], asMapKey, cache);\n    } else {\n      return b;\n    }\n  };\n  writer.JSONMarshaller.prototype.emitInteger = function(i, asMapKey, cache) {\n    if (i === Infinity) {\n      return this.emitString(d.ESC, \"z\", \"INF\", asMapKey, cache);\n    } else if (i === -Infinity) {\n      return this.emitString(d.ESC, \"z\", \"-INF\", asMapKey, cache);\n    } else if (isNaN(i)) {\n      return this.emitString(d.ESC, \"z\", \"NaN\", asMapKey, cache);\n    } else if (asMapKey || typeof i === \"string\" || i instanceof Long) {\n      return this.emitString(d.ESC, \"i\", i.toString(), asMapKey, cache);\n    } else {\n      return i;\n    }\n  };\n  writer.JSONMarshaller.prototype.emitDouble = function(d, asMapKey, cache) {\n    if (asMapKey) {\n      return this.emitString(d.ESC, \"d\", d, asMapKey, cache);\n    } else {\n      return d;\n    }\n  };\n  writer.JSONMarshaller.prototype.emitBinary = function(b, asMapKey, cache) {\n    return this.emitString(d.ESC, \"b\", b, asMapKey, cache);\n  };\n  writer.JSONMarshaller.prototype.emitQuoted = function(em, obj, cache) {\n    if (em.verbose) {\n      var ret = {}, k = this.emitString(d.ESC_TAG, \"'\", \"\", true, cache);\n      ret[k] = writer.marshal(this, obj, false, cache);\n      return ret;\n    } else {\n      return [this.emitString(d.ESC_TAG, \"'\", \"\", true, cache), writer.marshal(this, obj, false, cache)];\n    }\n  };\n  writer.emitObjects = function(em, iterable, cache) {\n    var ret = [];\n    if (util.isArray(iterable)) {\n      for (var i = 0; i < iterable.length; i++) {\n        ret.push(writer.marshal(em, iterable[i], false, cache));\n      }\n    } else {\n      iterable.forEach(function(v, i) {\n        ret.push(writer.marshal(em, v, false, cache));\n      });\n    }\n    return ret;\n  };\n  writer.emitArray = function(em, iterable, skip, cache) {\n    return writer.emitObjects(em, iterable, cache);\n  };\n  writer.isStringableKey = function(em, k) {\n    if (typeof k !== \"string\") {\n      var h = em.handler(k);\n      return h && h.tag(k).length === 1;\n    } else {\n      return true;\n    }\n  };\n  writer.stringableKeys = function(em, obj) {\n    var arr = em.unpack(obj), stringableKeys = true;\n    if (arr) {\n      for (var i = 0; i < arr.length; i += 2) {\n        stringableKeys = writer.isStringableKey(em, arr[i]);\n        if (!stringableKeys) {\n          break;\n        }\n      }\n      return stringableKeys;\n    } else if (obj.keys) {\n      var iter = obj.keys(), step = null;\n      if (iter.next) {\n        step = iter.next();\n        while (!step.done) {\n          stringableKeys = writer.isStringableKey(em, step.value);\n          if (!stringableKeys) {\n            break;\n          }\n          step = iter.next();\n        }\n        return stringableKeys;\n      }\n    }\n    if (obj.forEach) {\n      obj.forEach(function(v, k) {\n        stringableKeys = stringableKeys && writer.isStringableKey(em, k);\n      });\n      return stringableKeys;\n    } else {\n      throw new Error(\"Cannot walk keys of object type \" + handlers.constructor(obj).name);\n    }\n  };\n  writer.isForeignObject = function(x) {\n    if (x.constructor[\"transit$isObject\"]) {\n      return true;\n    }\n    var ret = x.constructor.toString();\n    ret = ret.substr(\"function \".length);\n    ret = ret.substr(0, ret.indexOf(\"(\"));\n    var isObject = ret == \"Object\";\n    if (typeof Object.defineProperty != \"undefined\") {\n      Object.defineProperty(x.constructor, \"transit$isObject\", {value:isObject, enumerable:false});\n    } else {\n      x.constructor[\"transit$isObject\"] = isObject;\n    }\n    return isObject;\n  };\n  writer.emitMap = function(em, obj, skip, cache) {\n    var arr = null, rep = null, tag = null, ks = null, i = 0;\n    if (obj.constructor === Object || obj.forEach != null || em.handlerForForeign && writer.isForeignObject(obj)) {\n      if (em.verbose) {\n        if (obj.forEach != null) {\n          if (writer.stringableKeys(em, obj)) {\n            var ret = {};\n            obj.forEach(function(v, k) {\n              ret[writer.marshal(em, k, true, false)] = writer.marshal(em, v, false, cache);\n            });\n            return ret;\n          } else {\n            arr = em.unpack(obj);\n            rep = [];\n            tag = em.emitString(d.ESC_TAG, \"cmap\", \"\", true, cache);\n            if (arr) {\n              for (; i < arr.length; i += 2) {\n                rep.push(writer.marshal(em, arr[i], false, false));\n                rep.push(writer.marshal(em, arr[i + 1], false, cache));\n              }\n            } else {\n              obj.forEach(function(v, k) {\n                rep.push(writer.marshal(em, k, false, false));\n                rep.push(writer.marshal(em, v, false, cache));\n              });\n            }\n            ret = {};\n            ret[tag] = rep;\n            return ret;\n          }\n        } else {\n          ks = util.objectKeys(obj);\n          ret = {};\n          for (; i < ks.length; i++) {\n            ret[writer.marshal(em, ks[i], true, false)] = writer.marshal(em, obj[ks[i]], false, cache);\n          }\n          return ret;\n        }\n      } else {\n        if (obj.forEach != null) {\n          if (writer.stringableKeys(em, obj)) {\n            arr = em.unpack(obj);\n            ret = [\"^ \"];\n            if (arr) {\n              for (; i < arr.length; i += 2) {\n                ret.push(writer.marshal(em, arr[i], true, cache));\n                ret.push(writer.marshal(em, arr[i + 1], false, cache));\n              }\n            } else {\n              obj.forEach(function(v, k) {\n                ret.push(writer.marshal(em, k, true, cache));\n                ret.push(writer.marshal(em, v, false, cache));\n              });\n            }\n            return ret;\n          } else {\n            arr = em.unpack(obj);\n            rep = [];\n            tag = em.emitString(d.ESC_TAG, \"cmap\", \"\", true, cache);\n            if (arr) {\n              for (; i < arr.length; i += 2) {\n                rep.push(writer.marshal(em, arr[i], false, cache));\n                rep.push(writer.marshal(em, arr[i + 1], false, cache));\n              }\n            } else {\n              obj.forEach(function(v, k) {\n                rep.push(writer.marshal(em, k, false, cache));\n                rep.push(writer.marshal(em, v, false, cache));\n              });\n            }\n            return [tag, rep];\n          }\n        } else {\n          ret = [\"^ \"];\n          ks = util.objectKeys(obj);\n          for (; i < ks.length; i++) {\n            ret.push(writer.marshal(em, ks[i], true, cache));\n            ret.push(writer.marshal(em, obj[ks[i]], false, cache));\n          }\n          return ret;\n        }\n      }\n    } else if (em.objectBuilder != null) {\n      return em.objectBuilder(obj, function(k) {\n        return writer.marshal(em, k, true, cache);\n      }, function(v) {\n        return writer.marshal(em, v, false, cache);\n      });\n    } else {\n      var name = handlers.constructor(obj).name, err = new Error(\"Cannot write \" + name);\n      err.data = {obj:obj, type:name};\n      throw err;\n    }\n  };\n  writer.emitTaggedMap = function(em, tag, rep, skip, cache) {\n    if (em.verbose) {\n      var ret = {};\n      ret[em.emitString(d.ESC_TAG, tag, \"\", true, cache)] = writer.marshal(em, rep, false, cache);\n      return ret;\n    } else {\n      return [em.emitString(d.ESC_TAG, tag, \"\", true, cache), writer.marshal(em, rep, false, cache)];\n    }\n  };\n  writer.emitEncoded = function(em, h, tag, rep, obj, asMapKey, cache) {\n    if (tag.length === 1) {\n      if (typeof rep === \"string\") {\n        return em.emitString(d.ESC, tag, rep, asMapKey, cache);\n      } else if (asMapKey || em.preferStrings) {\n        var vh = em.verbose && h.getVerboseHandler();\n        if (vh) {\n          tag = vh.tag(obj);\n          rep = vh.stringRep(obj, vh);\n        } else {\n          rep = h.stringRep(obj, h);\n        }\n        if (rep !== null) {\n          return em.emitString(d.ESC, tag, rep, asMapKey, cache);\n        } else {\n          var err = new Error('Tag \"' + tag + '\" cannot be encoded as string');\n          err.data = {tag:tag, rep:rep, obj:obj};\n          throw err;\n        }\n      } else {\n        return writer.emitTaggedMap(em, tag, rep, asMapKey, cache);\n      }\n    } else {\n      return writer.emitTaggedMap(em, tag, rep, asMapKey, cache);\n    }\n  };\n  writer.marshal = function(em, obj, asMapKey, cache) {\n    if (em.transform !== null) {\n      obj = em.transform(obj);\n    }\n    var h = em.handler(obj) || (em.handlerForForeign ? em.handlerForForeign(obj, em.handlers) : null), tag = h ? h.tag(obj) : null, rep = h ? h.rep(obj) : null;\n    if (h != null && tag != null) {\n      switch(tag) {\n        case \"_\":\n          return em.emitNil(asMapKey, cache);\n          break;\n        case \"s\":\n          return em.emitString(\"\", \"\", writer.escape(rep), asMapKey, cache);\n          break;\n        case \"?\":\n          return em.emitBoolean(rep, asMapKey, cache);\n          break;\n        case \"i\":\n          return em.emitInteger(rep, asMapKey, cache);\n          break;\n        case \"d\":\n          return em.emitDouble(rep, asMapKey, cache);\n          break;\n        case \"b\":\n          return em.emitBinary(rep, asMapKey, cache);\n          break;\n        case \"'\":\n          return em.emitQuoted(em, rep, cache);\n          break;\n        case \"array\":\n          return writer.emitArray(em, rep, asMapKey, cache);\n          break;\n        case \"map\":\n          return writer.emitMap(em, rep, asMapKey, cache);\n          break;\n        default:\n          return writer.emitEncoded(em, h, tag, rep, obj, asMapKey, cache);\n          break;\n      }\n    } else {\n      var name = handlers.constructor(obj).name, err = new Error(\"Cannot write \" + name);\n      err.data = {obj:obj, type:name};\n      throw err;\n    }\n  };\n  writer.maybeQuoted = function(em, obj) {\n    var h = em.handler(obj) || (em.handlerForForeign ? em.handlerForForeign(obj, em.handlers) : null);\n    if (h != null) {\n      if (h.tag(obj).length === 1) {\n        return types.quoted(obj);\n      } else {\n        return obj;\n      }\n    } else {\n      var name = handlers.constructor(obj).name, err = new Error(\"Cannot write \" + name);\n      err.data = {obj:obj, type:name};\n      throw err;\n    }\n  };\n  writer.marshalTop = function(em, obj, asMapKey, cache) {\n    return JSON.stringify(writer.marshal(em, writer.maybeQuoted(em, obj), asMapKey, cache));\n  };\n  writer.Writer = function Transit$Writer(marshaller, options) {\n    this._marshaller = marshaller;\n    this.options = options || {};\n    if (this.options[\"cache\"] === false) {\n      this.cache = null;\n    } else {\n      this.cache = this.options[\"cache\"] ? this.options[\"cache\"] : new caching.WriteCache();\n    }\n  };\n  writer.Writer.prototype.marshaller = function() {\n    return this._marshaller;\n  };\n  writer.Writer.prototype[\"marshaller\"] = writer.Writer.prototype.marshaller;\n  writer.Writer.prototype.write = function(obj, opts) {\n    var ret = null, ropts = opts || {}, asMapKey = ropts[\"asMapKey\"] || false, cache = this._marshaller.verbose ? false : this.cache;\n    if (ropts[\"marshalTop\"] === false) {\n      ret = writer.marshal(this._marshaller, obj, asMapKey, cache);\n    } else {\n      ret = writer.marshalTop(this._marshaller, obj, asMapKey, cache);\n    }\n    if (this.cache != null) {\n      this.cache.clear();\n    }\n    return ret;\n  };\n  writer.Writer.prototype[\"write\"] = writer.Writer.prototype.write;\n  writer.Writer.prototype.register = function(type, handler) {\n    this._marshaller.registerHandler(type, handler);\n  };\n  writer.Writer.prototype[\"register\"] = writer.Writer.prototype.register;\n});\n\n//# sourceMappingURL=com.cognitect.transit.impl.writer.js.map\n"],
"names":["goog","provide","require","scope","writer","com","cognitect","transit","impl","util","caching","handlers","types","d","delimiters","Long","math","escape","writer.escape","string","length","c","charAt","ESC","SUB","RES","JSONMarshaller","writer.JSONMarshaller","Transit$JSONMarshaller","opts","preferStrings","objectBuilder","transform","Handlers","optsHandlers","isArray","forEach","Error","self","v","k","undefined","set","handlerForForeign","unpack","x","isArrayMap","backingMap","_entries","verbose","prototype","handler","writer.JSONMarshaller.prototype.handler","obj","h","get","constructor","tag","registerHandler","writer.JSONMarshaller.prototype.registerHandler","ctor","emitNil","writer.JSONMarshaller.prototype.emitNil","asMapKey","cache","emitString","writer.JSONMarshaller.prototype.emitString","prefix","s","write","emitBoolean","writer.JSONMarshaller.prototype.emitBoolean","b","toString","emitInteger","writer.JSONMarshaller.prototype.emitInteger","i","Infinity","isNaN","emitDouble","writer.JSONMarshaller.prototype.emitDouble","emitBinary","writer.JSONMarshaller.prototype.emitBinary","emitQuoted","writer.JSONMarshaller.prototype.emitQuoted","em","ret","ESC_TAG","marshal","emitObjects","writer.emitObjects","iterable","push","emitArray","writer.emitArray","skip","isStringableKey","writer.isStringableKey","stringableKeys","writer.stringableKeys","arr","keys","iter","step","next","done","value","name","isForeignObject","writer.isForeignObject","substr","indexOf","isObject","Object","defineProperty","enumerable","emitMap","writer.emitMap","rep","ks","objectKeys","err","data","type","emitTaggedMap","writer.emitTaggedMap","emitEncoded","writer.emitEncoded","vh","getVerboseHandler","stringRep","writer.marshal","maybeQuoted","writer.maybeQuoted","quoted","marshalTop","writer.marshalTop","JSON","stringify","Writer","writer.Writer","Transit$Writer","marshaller","options","_marshaller","WriteCache","writer.Writer.prototype.marshaller","writer.Writer.prototype.write","ropts","clear","register","writer.Writer.prototype.register"]
}
